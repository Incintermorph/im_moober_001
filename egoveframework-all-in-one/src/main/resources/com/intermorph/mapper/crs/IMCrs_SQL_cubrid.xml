<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.intermorph.crs.crs.service.IMCrsMapper">

    <insert id="insert" parameterType="com.intermorph.crs.crs.service.IMCrsVO" useGeneratedKeys="false">
/* IMCrsMapper.insert */
INSERT INTO im_crs (
    crs_id,
    crs_mstr_id,
    edu_year,
    edu_rnd,
    ttnfee,
    edu_hrs,
    slctn_how_cdv,
    agncy_id,
    cntpnt,
    bnk_cdv,
    accno,
    acchdr,
    prsnl,
    prsnl_lmt,
    atch_file_id,
    prgrs_stts_cdv,
    stts_cdv,

    del_yn,
    frst_reger_id,
    frst_reg_dt,
    frst_reger_ip
) VALUES (
    #{crsId, jdbcType=VARCHAR},
    #{crsMstrId, jdbcType=VARCHAR},
    #{eduYear, jdbcType=VARCHAR},
    #{eduRnd, jdbcType=VARCHAR},
    #{ttnfee, jdbcType=VARCHAR},
    #{eduHrs, jdbcType=VARCHAR},
    #{slctnHowCdv, jdbcType=VARCHAR},
    #{agncyId, jdbcType=VARCHAR},
    #{cntpnt, jdbcType=VARCHAR},
    #{bnkCdv, jdbcType=VARCHAR},
    #{accno, jdbcType=VARCHAR},
    #{acchdr, jdbcType=VARCHAR},
    #{prsnl, jdbcType=VARCHAR},
    #{prsnlLmt, jdbcType=VARCHAR},
    #{atchFileId, jdbcType=VARCHAR},
    '01',
    #{sttsCdv, jdbcType=VARCHAR},

     'N',
    #{frstRegerId, jdbcType=VARCHAR},
    TO_CHAR(SYSDATETIME, 'yyyymmddhh24miss'),
    #{frstRegerIp, jdbcType=VARCHAR}
) 
    </insert>

    <update id="update" parameterType="com.intermorph.crs.crs.service.IMCrsVO">
/* IMCrsMapper.update */
UPDATE im_crs
   SET 
       edu_year = #{eduYear, jdbcType=VARCHAR},
       edu_rnd = #{eduRnd, jdbcType=VARCHAR},
       ttnfee = #{ttnfee, jdbcType=VARCHAR},
       edu_hrs = #{eduHrs, jdbcType=VARCHAR},
       slctn_how_cdv = #{slctnHowCdv, jdbcType=VARCHAR},
       cntpnt = #{cntpnt, jdbcType=VARCHAR},
       bnk_cdv = #{bnkCdv, jdbcType=VARCHAR},
       accno = #{accno, jdbcType=VARCHAR},
       acchdr = #{acchdr, jdbcType=VARCHAR},
       prsnl = #{prsnl, jdbcType=VARCHAR},
       prsnl_lmt = #{prsnlLmt, jdbcType=VARCHAR},
       atch_file_id = #{atchFileId, jdbcType=VARCHAR},
       stts_cdv = #{sttsCdv, jdbcType=VARCHAR},

	   last_mdfer_id = #{lastMdferId, jdbcType=VARCHAR},
       last_mdfcn_dt = TO_CHAR(SYSDATETIME, 'yyyymmddhh24miss'),
       last_mdfer_ip = #{lastMdferIp, jdbcType=VARCHAR}
 WHERE
       crs_id = #{crsId}

   AND del_yn = 'N'
    </update>
    <update id="updatePrgrsSttsCdv" parameterType="com.intermorph.crs.crs.service.IMCrsVO">
/* IMCrsMapper.updatePrgrsSttsCdv */
UPDATE im_crs
   SET 
       prgrs_stts_cdv = #{prgrsSttsCdv, jdbcType=VARCHAR},
	   last_mdfer_id = #{lastMdferId, jdbcType=VARCHAR},
       last_mdfcn_dt = TO_CHAR(SYSDATETIME, 'yyyymmddhh24miss'),
       last_mdfer_ip = #{lastMdferIp, jdbcType=VARCHAR}
 WHERE
       crs_id = #{crsId}
    </update>

    <update id="delete" parameterType="com.intermorph.crs.crs.service.IMCrsVO">
/* IMCrsMapper.delete */
UPDATE im_crs 
   SET last_mdfer_id = #{lastMdferId, jdbcType=VARCHAR},
       last_mdfcn_dt = TO_CHAR(SYSDATETIME, 'yyyymmddhh24miss'),
       last_mdfer_ip = #{lastMdferIp, jdbcType=VARCHAR},
       del_yn = 'Y' 
 WHERE 
       crs_id = #{crsId}

   AND del_yn = 'N'
    </update>

    <resultMap id="selectDetailResultMap" type="com.intermorph.crs.crs.service.IMCrsResultSet">
        <result column="A.crsId" property="crs.crsId"/>
        <result column="A.crsMstrId" property="crs.crsMstrId"/>
        <result column="A.eduYear" property="crs.eduYear"/>
        <result column="A.eduRnd" property="crs.eduRnd"/>
        <result column="A.ttnfee" property="crs.ttnfee"/>
        <result column="A.eduHrs" property="crs.eduHrs"/>
        <result column="A.slctnHowCdv" property="crs.slctnHowCdv"/>
        <result column="A.agncyId" property="crs.agncyId"/>
        <result column="A.cntpnt" property="crs.cntpnt"/>
        <result column="A.bnkCdv" property="crs.bnkCdv"/>
        <result column="A.accno" property="crs.accno"/>
        <result column="A.acchdr" property="crs.acchdr"/>
        <result column="A.prsnl" property="crs.prsnl"/>
        <result column="A.prsnlLmt" property="crs.prsnlLmt"/>
        <result column="A.atchFileId" property="crs.atchFileId"/>
        <result column="A.prgrsSttsCdv" property="crs.prgrsSttsCdv"/>
        <result column="A.sttsCdv" property="crs.sttsCdv"/>
        <result column="A.delYn" property="crs.delYn"/>
        <result column="A.frstRegerId" property="crs.frstRegerId"/>
        <result column="A.frstRegDt" property="crs.frstRegDt"/>
        <result column="A.frstRegerIp" property="crs.frstRegerIp"/>
        <result column="A.lastMdferId" property="crs.lastMdferId"/>
        <result column="A.lastMdfcnDt" property="crs.lastMdfcnDt"/>
        <result column="A.lastMdferIp" property="crs.lastMdferIp"/>
        <result column="B.crsGrdCdv" property="crsMstr.crsGrdCdv"/>
        <result column="B.crsDvsnCdv" property="crsMstr.crsDvsnCdv"/>
        <result column="E.agncyNm" property="agncy.agncyNm"/>
        <result column="E.fnshCode" property="agncy.fnshCode"/>
        <result column="procType" property="procType"/>

    </resultMap>
    <select id="selectDetail" parameterType="com.intermorph.crs.crs.service.IMCrsVO" resultMap="selectDetailResultMap">
        /* IMCrsMapper.selectDetail */
SELECT 
       A.crs_id AS "A.crsId",
       A.crs_mstr_id AS "A.crsMstrId",
       A.edu_year AS "A.eduYear",
       A.edu_rnd AS "A.eduRnd",
       A.ttnfee AS "A.ttnfee",
       A.edu_hrs AS "A.eduHrs",
       A.slctn_how_cdv AS "A.slctnHowCdv",
       A.agncy_id AS "A.agncyId",
       A.cntpnt AS "A.cntpnt",
       A.bnk_cdv AS "A.bnkCdv",
       A.accno AS "A.accno",
       A.acchdr AS "A.acchdr",
       A.prsnl AS "A.prsnl",
       A.prsnl_lmt AS "A.prsnlLmt",
       A.atch_file_id AS "A.atchFileId",
       A.stts_cdv AS "A.sttsCdv",
       A.prgrs_stts_cdv AS "A.prgrsSttsCdv",
       A.del_yn AS "A.delYn",
       A.frst_reger_id AS "A.frstRegerId",
       A.frst_reg_dt AS "A.frstRegDt",
       A.frst_reger_ip AS "A.frstRegerIp",
       A.last_mdfer_id AS "A.lastMdferId",
       A.last_mdfcn_dt AS "A.lastMdfcnDt",
       A.last_mdfer_ip AS "A.lastMdferIp",
	   B.crs_grd_cdv AS "B.crsGrdCdv",
       B.crs_dvsn_cdv AS "B.crsDvsnCdv",
       E.agncy_nm AS "E.agncyNm", 
       E.fnsh_code AS "E.fnshCode", 
       <![CDATA[
       CASE 
       		WHEN  TO_CHAR(SYSDATETIME, 'yyyymmddhh24miss')>C.bgn_dt AND TO_CHAR(SYSDATETIME, 'yyyymmddhh24miss')< C.end_dt THEN 'I'
       		WHEN   TO_CHAR(SYSDATETIME, 'yyyymmddhh24miss')<C.bgn_dt  THEN 'W'
       	ELSE 'E' END AS 	"procType"
       			]]>
  
  FROM im_crs A
  INNER JOIN im_crs_mstr B ON A.crs_mstr_id=B.crs_mstr_id    
  INNER JOIN im_cmmn_dt C ON A.crs_id=C.tbl_ref_id AND C.tbl_id='IM_CRS' AND C.ref_nm='eduAplTerm'
  INNER JOIN im_cmmn_dt D ON A.crs_id=D.tbl_ref_id AND D.tbl_id='IM_CRS' AND D.ref_nm='eduTerm'
  INNER JOIN im_agncy E ON A.agncy_id=E.agncy_id
 WHERE
       crs_id = #{crsId}

   AND A.del_yn = 'N'
    </select>


    <resultMap id="selectListResultMap" type="com.intermorph.crs.crs.service.IMCrsResultSet">
        <result column="A.crsId" property="crs.crsId"/>
        <result column="A.crsMstrId" property="crs.crsMstrId"/>
        <result column="A.eduYear" property="crs.eduYear"/>
        <result column="A.eduRnd" property="crs.eduRnd"/>
        <result column="A.ttnfee" property="crs.ttnfee"/>
        <result column="A.eduHrs" property="crs.eduHrs"/>
        <result column="A.slctnHowCdv" property="crs.slctnHowCdv"/>
        <result column="A.agncyId" property="crs.agncyId"/>
        <result column="A.cntpnt" property="crs.cntpnt"/>
        <result column="A.bnkCdv" property="crs.bnkCdv"/>
        <result column="A.accno" property="crs.accno"/>
        <result column="A.acchdr" property="crs.acchdr"/>
        <result column="A.prsnl" property="crs.prsnl"/>
        <result column="A.prsnlLmt" property="crs.prsnlLmt"/>
        <result column="A.atchFileId" property="crs.atchFileId"/>
        <result column="A.prgrsSttsCdv" property="crs.prgrsSttsCdv"/>
        <result column="A.sttsCdv" property="crs.sttsCdv"/>
        <result column="A.delYn" property="crs.delYn"/>
        <result column="A.frstRegerId" property="crs.frstRegerId"/>
        <result column="A.frstRegDt" property="crs.frstRegDt"/>
        <result column="A.frstRegerIp" property="crs.frstRegerIp"/>
        <result column="A.lastMdferId" property="crs.lastMdferId"/>
        <result column="A.lastMdfcnDt" property="crs.lastMdfcnDt"/>
        <result column="A.lastMdferIp" property="crs.lastMdferIp"/>
        <result column="B.crsGrdCdv" property="crsMstr.crsGrdCdv"/>
        <result column="B.crsDvsnCdv" property="crsMstr.crsDvsnCdv"/>
        <result column="A.eduAplTerm_bgnDt" property="crs.eduAplTerm_bgnDt"/>
        <result column="A.eduAplTerm_endDt" property="crs.eduAplTerm_endDt"/>
        <result column="A.eduTerm_bgnDt" property="crs.eduTerm_bgnDt"/>
        <result column="A.eduTerm_endDt" property="crs.eduTerm_endDt"/>
        <result column="E.agncyNm" property="agncy.agncyNm"/>
        <result column="E.fnshCode" property="agncy.fnshCode"/>
        <result column="procType" property="procType"/>
        <result column="aply02Cnt" property="aply02Cnt"/>
        <result column="fnsh02Cnt" property="fnsh02Cnt"/>

    </resultMap>
    <select id="selectList" parameterType="com.intermorph.crs.crs.service.IMCrsCondition" resultMap="selectListResultMap">
/* IMCrsMapper.selectList */
         <if test='currentPageNo != 0'>
SELECT * FROM ( SELECT rownum rn, TB.* FROM (
        </if>
SELECT
       A.crs_id AS "A.crsId",
       A.crs_mstr_id AS "A.crsMstrId",
       A.edu_year AS "A.eduYear",
       A.edu_rnd AS "A.eduRnd",
       A.ttnfee AS "A.ttnfee",
       A.edu_hrs AS "A.eduHrs",
       A.slctn_how_cdv AS "A.slctnHowCdv",
       A.agncy_id AS "A.agncyId",
       A.cntpnt AS "A.cntpnt",
       A.bnk_cdv AS "A.bnkCdv",
       A.accno AS "A.accno",
       A.acchdr AS "A.acchdr",
       A.prsnl AS "A.prsnl",
       A.prsnl_lmt AS "A.prsnlLmt",
       A.atch_file_id AS "A.atchFileId",
       A.prgrs_stts_cdv AS "A.prgrsSttsCdv",
       A.stts_cdv AS "A.sttsCdv",
       A.del_yn AS "A.delYn",
       A.frst_reger_id AS "A.frstRegerId",
       A.frst_reg_dt AS "A.frstRegDt",
       A.frst_reger_ip AS "A.frstRegerIp",
       A.last_mdfer_id AS "A.lastMdferId",
       A.last_mdfcn_dt AS "A.lastMdfcnDt",
       A.last_mdfer_ip AS "A.lastMdferIp",
	   B.crs_grd_cdv AS "B.crsGrdCdv",
       B.crs_dvsn_cdv AS "B.crsDvsnCdv",
       C.bgn_dt AS "A.eduAplTerm_bgnDt" ,
       C.end_dt AS "A.eduAplTerm_endDt" ,       
       D.bgn_dt AS "A.eduTerm_bgnDt" ,
       D.end_dt AS "A.eduTerm_endDt" ,
       E.agncy_nm AS "E.agncyNm", 
       E.fnsh_code AS "E.fnshCode", 
       <if test='scStatYn != null and !scStatYn.equals("")'>
       aply.applyCnt AS "aply02Cnt", 
       fnsh.fnshCnt AS "fnsh02Cnt", 
  	   </if>
       <![CDATA[
       CASE 
       		WHEN  TO_CHAR(SYSDATETIME, 'yyyymmddhh24miss')>C.bgn_dt AND TO_CHAR(SYSDATETIME, 'yyyymmddhh24miss')< C.end_dt THEN 'I'
       		WHEN   TO_CHAR(SYSDATETIME, 'yyyymmddhh24miss')<C.bgn_dt  THEN 'W'
       	ELSE 'E' END AS 	"procType"
       			]]>

  FROM im_crs A
  INNER JOIN im_crs_mstr B ON A.crs_mstr_id=B.crs_mstr_id  
  INNER JOIN im_cmmn_dt C ON A.crs_id=C.tbl_ref_id AND C.tbl_id='IM_CRS' AND C.ref_nm='eduAplTerm'
  INNER JOIN im_cmmn_dt D ON A.crs_id=D.tbl_ref_id AND D.tbl_id='IM_CRS' AND D.ref_nm='eduTerm'
  INNER JOIN im_agncy E ON A.agncy_id=E.agncy_id
  <if test='scStatYn != null and !scStatYn.equals("")'>
  LEFT OUTER JOIN (
	 SELECT   b.crs_id,
	          COUNT(*) applyCnt
	 FROM     im_crs_aplcnt a
	          INNER JOIN im_crs b
	          ON       a.crs_id=b.crs_id
	          INNER JOIN im_cmmn_stts d
	          ON       a.crs_aplcnt_id=tbl_ref_id
	          AND      d.tbl_id       ='IM_CRS_APLCNT'
	          AND      d.ref_nm       ='APLY'
	          AND      d.stts_cdv     ='02'
	 WHERE    a.del_yn                ='N'
	 AND      b.del_yn                ='N'
	 GROUP BY b.crs_id
  ) AS aply ON aply.crs_id=A.crs_id
  LEFT OUTER JOIN (
		 SELECT   b.crs_id,
		          COUNT(*) fnshCnt
		 FROM     im_crs_aplcnt a
		          INNER JOIN im_crs b
		          ON       a.crs_id=b.crs_id
		          INNER JOIN im_cmmn_stts c
		          ON       a.crs_aplcnt_id=c.tbl_ref_id
		          AND      c.tbl_id       ='IM_CRS_APLCNT'
		          AND      c.ref_nm       ='FNSH'
		          AND      c.stts_cdv     ='02'
		          INNER JOIN im_cmmn_stts d
		          ON       a.crs_aplcnt_id=d.tbl_ref_id
		          AND      d.tbl_id       ='IM_CRS_APLCNT'
		          AND      d.ref_nm       ='APLY'
		          AND      d.stts_cdv     ='02'
		 WHERE    a.del_yn                ='N'
		 AND      b.del_yn                ='N'
		 GROUP BY b.crs_id
  ) AS  fnsh ON fnsh.crs_id=A.crs_id
  </if>
 WHERE A.del_yn = 'N'
 
 		<if test='scWord != null and !scWord.equals("")'>
            <if test='scKey.equals("crsId")'>
       			AND A.crs_id LIKE CONCAT('%', #{scWord}, '%')
            </if>
            <if test='scKey.equals("agncyNm")'>
       			AND E.agncy_nm LIKE CONCAT('%', #{scWord}, '%')
            </if>
        </if>
        <if test='scCrsGrdCdv != null and !scCrsGrdCdv.equals("")'>
       			AND B.crs_grd_cdv = #{scCrsGrdCdv}
        </if>
        <if test='scCrsDvsnCdv != null and !scCrsDvsnCdv.equals("")'>
       			AND B.crs_dvsn_cdv = #{scCrsDvsnCdv}
        </if>
        <if test='scNotCrsDvsnCdv != null and !scNotCrsDvsnCdv.equals("")'>
       			AND B.crs_dvsn_cdv != #{scNotCrsDvsnCdv}
        </if>
        <if test='scSttsCdv != null and !scSttsCdv.equals("")'>
       			AND A.stts_cdv = #{scSttsCdv}
        </if>
        <if test='scAgncyId != null and !scAgncyId.equals("")'>
       			AND A.agncy_id = #{scAgncyId}
        </if>
        <if test='scEduYear != null and !scEduYear.equals("")'>
       			AND A.edu_year = #{scEduYear}
        </if>
        <if test='scEduRnd != null and !scEduRnd.equals("")'>
       			AND A.edu_rnd = #{scEduRnd}
        </if>
        <if test='scPrgrsSttsCdv != null and !scPrgrsSttsCdv.equals("")'>
       			AND A.prgrs_stts_cdv = #{scPrgrsSttsCdv}
        </if>
         
        
         <if test='scProcType != null and !scProcType.equals("")'>
       			<if test='scProcType.equals("I")'>
       			<![CDATA[
       			AND TO_CHAR(SYSDATETIME, 'yyyymmddhh24miss')>C.bgn_dt AND TO_CHAR(SYSDATETIME, 'yyyymmddhh24miss')< C.end_dt
       			]]>
            	</if>
       			<if test='scProcType.equals("W")'>
       			<![CDATA[
       			AND TO_CHAR(SYSDATETIME, 'yyyymmddhh24miss')<C.bgn_dt 
       			]]>
            	</if>
       			<if test='scProcType.equals("E")'>
       			<![CDATA[
       			AND TO_CHAR(SYSDATETIME, 'yyyymmddhh24miss') > C.end_dt
       			]]>
            	</if>
        </if>
 
 
  		<choose>
            <when test='orderbyKey == 3'>ORDER BY  D.bgn_dt ASC</when>
            <when test='orderbyKey == -3'>ORDER BY  D.bgn_dt DESC</when>
            <when test='orderbyKey == 2'>ORDER BY  C.bgn_dt ASC</when>
            <when test='orderbyKey == -2'>ORDER BY  C.bgn_dt DESC</when>
            <when test='orderbyKey == 1'>ORDER BY A.frst_reg_dt ASC</when>
            <when test='orderbyKey == -1'>ORDER BY A.frst_reg_dt DESC</when>
            <otherwise>ORDER BY A.frst_reg_dt DESC</otherwise>
        </choose>

        <if test='currentPageNo != 0'>
        ) TB ) WHERE rn BETWEEN #{firstItemNo}+1  AND #{firstItemNo} + #{recordCountPerPage}
        </if>
    </select>

    <select id="selectListCount" parameterType="com.intermorph.crs.crs.service.IMCrsCondition" resultType="int">
/* IMCrsMapper.selectListCount */
SELECT COUNT(*) 
  
  FROM im_crs A
  INNER JOIN im_crs_mstr B ON A.crs_mstr_id=B.crs_mstr_id  
  INNER JOIN im_cmmn_dt C ON A.crs_id=C.tbl_ref_id AND C.tbl_id='IM_CRS' AND C.ref_nm='eduAplTerm'
  INNER JOIN im_cmmn_dt D ON A.crs_id=D.tbl_ref_id AND D.tbl_id='IM_CRS' AND D.ref_nm='eduTerm'
  INNER JOIN im_agncy E ON A.agncy_id=E.agncy_id
  <if test='scStatYn != null and !scStatYn.equals("")'>
  LEFT OUTER JOIN (
	 SELECT   b.crs_id,
	          COUNT(*) applyCnt
	 FROM     im_crs_aplcnt a
	          INNER JOIN im_crs b
	          ON       a.crs_id=b.crs_id
	          INNER JOIN im_cmmn_stts d
	          ON       a.crs_aplcnt_id=tbl_ref_id
	          AND      d.tbl_id       ='IM_CRS_APLCNT'
	          AND      d.ref_nm       ='APLY'
	          AND      d.stts_cdv     ='02'
	 WHERE    a.del_yn                ='N'
	 AND      b.del_yn                ='N'
	 GROUP BY b.crs_id
  ) AS aply ON aply.crs_id=A.crs_id
  LEFT OUTER JOIN (
		 SELECT   b.crs_id,
		          COUNT(*) fnshCnt
		 FROM     im_crs_aplcnt a
		          INNER JOIN im_crs b
		          ON       a.crs_id=b.crs_id
		          INNER JOIN im_cmmn_stts c
		          ON       a.crs_aplcnt_id=c.tbl_ref_id
		          AND      c.tbl_id       ='IM_CRS_APLCNT'
		          AND      c.ref_nm       ='FNSH'
		          AND      c.stts_cdv     ='02'
		          INNER JOIN im_cmmn_stts d
		          ON       a.crs_aplcnt_id=d.tbl_ref_id
		          AND      d.tbl_id       ='IM_CRS_APLCNT'
		          AND      d.ref_nm       ='APLY'
		          AND      d.stts_cdv     ='02'
		 WHERE    a.del_yn                ='N'
		 AND      b.del_yn                ='N'
		 GROUP BY b.crs_id
  ) AS  fnsh ON fnsh.crs_id=A.crs_id
  </if>
 WHERE A.del_yn = 'N'  
 <if test='scWord != null and !scWord.equals("")'>
            <if test='scKey.equals("crsId")'>
       			AND A.crs_id LIKE CONCAT('%', #{scWord}, '%')
            </if>
            <if test='scKey.equals("agncyNm")'>
       			AND E.agncy_nm LIKE CONCAT('%', #{scWord}, '%')
            </if>
        </if>
        <if test='scCrsGrdCdv != null and !scCrsGrdCdv.equals("")'>
       			AND B.crs_grd_cdv = #{scCrsGrdCdv}
        </if>
        <if test='scCrsDvsnCdv != null and !scCrsDvsnCdv.equals("")'>
       			AND B.crs_dvsn_cdv = #{scCrsDvsnCdv}
        </if>
        <if test='scNotCrsDvsnCdv != null and !scNotCrsDvsnCdv.equals("")'>
       			AND B.crs_dvsn_cdv != #{scNotCrsDvsnCdv}
        </if>
        <if test='scSttsCdv != null and !scSttsCdv.equals("")'>
       			AND A.stts_cdv = #{scSttsCdv}
        </if>
        <if test='scAgncyId != null and !scAgncyId.equals("")'>
       			AND A.agncy_id = #{scAgncyId}
        </if>
        <if test='scEduYear != null and !scEduYear.equals("")'>
       			AND A.edu_year = #{scEduYear}
        </if>
        <if test='scEduRnd != null and !scEduRnd.equals("")'>
       			AND A.edu_rnd = #{scEduRnd}
        </if>
        <if test='scPrgrsSttsCdv != null and !scPrgrsSttsCdv.equals("")'>
       			AND A.prgrs_stts_cdv = #{scPrgrsSttsCdv}
        </if>
         
        
         <if test='scProcType != null and !scProcType.equals("")'>
       			<if test='scProcType.equals("I")'>
       			<![CDATA[
       			AND TO_CHAR(SYSDATETIME, 'yyyymmddhh24miss')>C.bgn_dt AND TO_CHAR(SYSDATETIME, 'yyyymmddhh24miss')< C.end_dt
       			]]>
            	</if>
       			<if test='scProcType.equals("W")'>
       			<![CDATA[
       			AND TO_CHAR(SYSDATETIME, 'yyyymmddhh24miss')<C.bgn_dt 
       			]]>
            	</if>
       			<if test='scProcType.equals("E")'>
       			<![CDATA[
       			AND TO_CHAR(SYSDATETIME, 'yyyymmddhh24miss') > C.end_dt
       			]]>
            	</if>
        </if>
 
    </select>
    
      <select id="selectDetailChkInfo" parameterType="com.intermorph.crs.crs.service.IMCrsVO" resultType="com.intermorph.crs.crs.service.IMCrsVO">
        /* IMCrsMapper.selectDetailChkInfo */
SELECT 
       A.crs_id AS "crsId",
       A.crs_mstr_id AS "crsMstrId",
       A.edu_year AS "eduYear",
       A.edu_rnd AS "eduRnd",
       A.ttnfee AS "ttnfee",
       A.edu_hrs AS "eduHrs",
       A.agncy_id AS "agncyId",
       A.prsnl AS "prsnl",
       A.prsnl_lmt AS "prsnlLmt",
       A.del_yn AS "A.delYn"
  FROM im_crs A   
  INNER JOIN im_cmmn_dt C ON A.crs_id=C.tbl_ref_id AND C.tbl_id='IM_CRS' AND C.ref_nm='eduAplTerm'
 WHERE
       crs_id = #{crsId}
   AND stts_cdv = 'STTS_02'
   AND A.del_yn = 'N'
   <![CDATA[
   AND TO_CHAR(SYSDATETIME, 'yyyymmddhh24miss')>C.bgn_dt AND TO_CHAR(SYSDATETIME, 'yyyymmddhh24miss')< C.end_dt
   ]]>
    </select>
</mapper>